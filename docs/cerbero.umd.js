!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).cerbero=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};const t="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&"function"==typeof module.require?module.require:null;var r=function(e){if(t){const r=t("worker_threads").Worker;return function(t){return new r(e,t)}}return function(t){return new Worker(e,t)}}("web-worker-0.js");return new function(){var t=this;if(this.textEncoder=new TextEncoder,this.addEventListner=function(e){t.cb=e},this._getDomNode=function(e){var t=e.id;return e.nodeName.toLowerCase()+(t?"#"+t:"")},this._calculateDomStructure=function(e){var r="";return e.parentElement&&(r=t._calculateDomStructure(e.parentElement)),r+" > "+t._getDomNode(e)},this._formatNode=function(e){var r=e.id,n=e.name,o=e.nodeName,i=e.constructor,s=e.className,c=e.getBoundingClientRect;return{id:r,name:n,className:s,type:o,domType:i.name,identifier:t._getDomNode(e),domStructure:t._calculateDomStructure(e),position:c?e.getBoundingClientRect():{}}},this._formatEvent=function(r){var n={};for(var o in r)r[o]instanceof Node?n[o]=t._formatNode(r[o]):r[o]instanceof Window?n[o]="Window":r[o]instanceof window.InputDeviceCapabilities==0&&"function"!=typeof r[o]&&(n[o]=r[o]);return n.path=null,e({},n)},this._sendToWorker=function(e,r,n){void 0===n&&(n=!1);var o=n?t._formatEvent(r):r;o=t.textEncoder.encode(JSON.stringify(o)),t.cerberoWorker.postMessage({type:e,event:o})},this._receiveWorkerMessage=function(e){if(!t.cb)throw new Error("[Cerbero] no callback setted");t.cb.apply(null,[e.data])},this._initListener=function(){document.addEventListener("click",(function(e){return t._sendToWorker("click",e,!0)})),t.cerberoWorker.onmessage=t._receiveWorkerMessage},"undefined"==typeof Worker)return null;this.cerberoWorker=new r,this._initListener=this._initListener.bind(this),this._sendToWorker=this._sendToWorker.bind(this),this._formatEvent=this._formatEvent.bind(this),this._formatNode=this._formatNode.bind(this),this._calculateDomStructure=this._calculateDomStructure.bind(this),this._receiveWorkerMessage=this._receiveWorkerMessage.bind(this),this._sendToWorker("performance",window.performance),this._initListener()}}));
