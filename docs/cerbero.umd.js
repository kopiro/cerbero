!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).cerbero=t()}(this,(function(){"use strict";function e(e,t,n){var i=void 0===t?null:t,l=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),l=0,o=n.length;l<o;++l)i[l]=n.charCodeAt(l);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(e,void 0!==n&&n),o=l.indexOf("\n",10)+1,c=l.substring(o)+(i?"//# sourceMappingURL="+i:""),r=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(r)}var t,n,i,l,o=(t="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwp2YXIgZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUuZm9ybWF0RXZlbnQ9ZnVuY3Rpb24oZSl7dmFyIHQ9RGF0ZS5ub3coKTtyZXR1cm57dHlwZToiY2xpY2siLHRpbWU6dCxhZnRlcjp0LWUuc3RhcnREYXRlLGRhdGE6e3Bvc2l0aW9uOntzY3JlZW5YOmUuc2NyZWVuWCxzY3JlZW5ZOmUuc2NyZWVuWSxjbGllbnRYOmUuY2xpZW50WCxjbGllbnRZOmUuY2xpZW50WSxwYWdlWDplLnBhZ2VYLHBhZ2VZOmUucGFnZVkseDplLngseTplLnksb2Zmc2V0WDplLm9mZnNldFgsb2Zmc2V0WTplLm9mZnNldFl9LGtleXM6e2N0cmxLZXk6ZS5jdHJsS2V5LHNoaWZ0S2V5OmUuc2hpZnRLZXksYWx0S2V5OmUuYWx0S2V5LG1ldGFLZXk6ZS5tZXRhS2V5fSxlbGVtZW50czp7dGFyZ2V0OmUudGFyZ2V0fX19fSxlfSgpLHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLmZvcm1hdEV2ZW50PWZ1bmN0aW9uKGUpe3JldHVybnt0eXBlOiJwZXJmb3JtYW5jZSIsdGltZTpEYXRlLm5vdygpLGRhdGE6e3RpbWluZzplLnRpbWluZyxuYXZpZ2F0aW9uOmUubmF2aWdhdGlvbixtZW1vcnk6ZS5tZW1vcnl9fX0sZX0oKSxuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5mb3JtYXRFdmVudD1mdW5jdGlvbihlKXt2YXIgdD1EYXRlLm5vdygpO3JldHVybnt0eXBlOiJtb3VzZUV4aXQiLHRpbWU6dCxhZnRlcjp0LWUuc3RhcnREYXRlLGRhdGE6e3Bvc2l0aW9uOntzY3JlZW5YOmUuc2NyZWVuWCxzY3JlZW5ZOmUuc2NyZWVuWSxjbGllbnRYOmUuY2xpZW50WCxjbGllbnRZOmUuY2xpZW50WSxwYWdlWDplLnBhZ2VYLHBhZ2VZOmUucGFnZVkseDplLngseTplLnksb2Zmc2V0WDplLm9mZnNldFgsb2Zmc2V0WTplLm9mZnNldFl9LGtleXM6e2N0cmxLZXk6ZS5jdHJsS2V5LHNoaWZ0S2V5OmUuc2hpZnRLZXksYWx0S2V5OmUuYWx0S2V5LG1ldGFLZXk6ZS5tZXRhS2V5fSxlbGVtZW50czp7ZnJvbUVsZW1lbnQ6ZS5mcm9tRWxlbWVudH19fX0sZX0oKSxvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5mb3JtYXRFdmVudD1mdW5jdGlvbihlKXt2YXIgdD1EYXRlLm5vdygpLG49ZS5ldmVudCxvPW4uYW5jaG9yTm9kZSxzPW4uYW5jaG9yT2Zmc2V0LGE9bi5mb2N1c05vZGUscj1uLmZvY3VzT2Zmc2V0LGY9bi5iYXNlTm9kZSxpPW4uYmFzZU9mZnNldCxjPW4uZXh0ZW50Tm9kZSxsPW4uZXh0ZW50T2Zmc2V0O3JldHVybiBvLm9mZnNldD1zLGEub2Zmc2V0PXIsZi5vZmZzZXQ9aSxjLm9mZnNldD1sLHt0eXBlOiJzZWxlY3Rpb24iLHRpbWU6dCxhZnRlcjp0LWUuc3RhcnREYXRlLGRhdGE6e3RleHQ6ZS5zZWxlY3Rpb24sZWxlbWVudHM6e2FuY2hvck5vZGU6byxmb2N1c05vZGU6YSxiYXNlTm9kZTpmLGV4dGVudE5vZGU6Y319fX0sZX0oKSxzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5mb3JtYXRFdmVudD1mdW5jdGlvbihlKXt2YXIgdD1lLmV2ZW50LG49ZS5zY3JvbGwsbz1lLmhlaWdodCxzPWUuc3RhcnREYXRlLGE9RGF0ZS5ub3coKTtyZXR1cm57dHlwZToic2Nyb2xsIix0aW1lOmEsYWZ0ZXI6YS1zLGRhdGE6e3Njcm9sbDp7ZnJvbVRvcDpuLGRvbUhlaWdodDpvLHBlcmNlbnRhZ2U6TWF0aC5jZWlsKDEwMCpuL28pfSxlbGVtZW50czp7c3JjRWxlbWVudDp0LnNyY0VsZW1lbnQsdGFyZ2V0OnQudGFyZ2V0fX19fSxlfSgpO25ldyBmdW5jdGlvbigpe3ZhciBhPXRoaXM7dGhpcy50ZXh0RGVjb2Rlcj1uZXcgVGV4dERlY29kZXIsdGhpcy5mb3JtYXR0ZXJzPXtjbGljazplLHBlcmZvcm1hbmNlOnQsbW91c2VleGl0Om4sc2VsZWN0aW9uOm8sc2Nyb2xsOnN9LHRoaXMub25NZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciB0LG49ZS5kYXRhLG89bi50eXBlLHM9bi5ldmVudCxyPUpTT04ucGFyc2UoYS50ZXh0RGVjb2Rlci5kZWNvZGUocykpO2EuZm9ybWF0dGVyc1tvXSYmKHQ9YS5mb3JtYXR0ZXJzW29dLmZvcm1hdEV2ZW50KHIpKSx0JiZwb3N0TWVzc2FnZSh0LG51bGwpfSx0aGlzLnNlbGY9c2VsZix0aGlzLnNlbGYuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsdGhpcy5vbk1lc3NhZ2UuYmluZCh0aGlzKSksdGhpcy5vbk1lc3NhZ2U9dGhpcy5vbk1lc3NhZ2UuYmluZCh0aGlzKX07Cgo=",n="data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbXSwic291cmNlc0NvbnRlbnQiOltdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIn0=",i=!1,function(o){return l=l||e(t,n,i),new Worker(l,o)}),c=function(){return(c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},r=function(e){var t=e.id;return e.nodeName.toLowerCase()+(t?"#"+t:"")},Z=function(e){var t="";return e.parentElement&&(t=Z(e.parentElement)),console.log("getDomNode",e),t+" > "+r(e)},d=function(e){var t=e.id,n=e.name,i=e.nodeName,l=e.constructor,o=e.className,c=e.getBoundingClientRect;console.log("calculateDomStructure",e);var d={id:t,name:n,className:o,type:i,domType:l.name||"",identifier:r(e),domStructure:Z(e),position:c?e.getBoundingClientRect():{}};return e.data&&(d.data=e.data),e.wholeText&&(d.wholeText=e.wholeText),e.nodeValue&&(d.nodeValue=e.nodeValue),e.textContent&&(d.textContent=e.textContent),d},s=function(e){var t,n={},i=window.InputDeviceCapabilities;for(var l in e)e[l]&&"MemoryInfo"===e[l].constructor.name?n[l]={totalJSHeapSize:(t=e[l]).totalJSHeapSize,usedJSHeapSize:t.usedJSHeapSize,jsHeapSizeLimit:t.jsHeapSizeLimit}:e[l]instanceof Node?n[l]=d(e[l]):e[l]instanceof Window?n[l]="Window":e[l]instanceof i==!1&&"function"!=typeof e[l]&&(n[l]=e[l]);return n.path=null,c({},n)},u=function(e){var t=this;this.cb=function(e){return null},this.selection="",this.getSelectionText=function(){return window.getSelection().toString()},this.observerValue=function(){var e=t.getSelectionText();e!==t.selection&&""!==e&&(t.selection=e,t.cb({event:window.getSelection(),text:t.selection}))},this.cb=e,this.observerValue=this.observerValue.bind(this),setInterval(this.observerValue,2e3)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */return new function(){var e=this;if(this.textEncoder=new TextEncoder,this.addEventListner=function(t){e.cb=t},this._sendToWorker=function(t,n,i){void 0===i&&(i=!0);var l=i?s(n):n;l.startDate=e.startDate,l=e.textEncoder.encode(JSON.stringify(l)),e.cerberoWorker.postMessage({type:t,event:l})},this._receiveWorkerMessage=function(t){if(!e.cb)throw new Error("[Cerbero] no callback setted");e.cb.apply(null,[t.data])},this._receiveSelectionEvent=function(t){e._sendToWorker("selection",{event:s(t.event),selection:t.text},!1)},this._receiveScrollEvent=function(t){var n=document.body,i=document.documentElement;window.clearTimeout(e.isScrolling),e.isScrolling=setTimeout((function(){var l=Math.max(n.scrollHeight,n.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);e._sendToWorker("scroll",{event:s(t),height:l,scroll:window.scrollY||window.pageYOffset},!1)}),100)},this._receiveMouseOutEvent=function(t){var n=t.toElement;n&&"HTML"!==n.nodeName||"HTML"===t.fromElement.nodeName||e._sendToWorker("mouseexit",t)},this._initListener=function(){e._sendToWorker("performance",window.performance),document.addEventListener("click",(function(t){return e._sendToWorker("click",t)})),window.addEventListener("mouseout",e._receiveMouseOutEvent,!1),new u(e._receiveSelectionEvent),window.addEventListener("scroll",e._receiveScrollEvent,!1),e.cerberoWorker.onmessage=e._receiveWorkerMessage},"undefined"==typeof Worker)return null;this.startDate=Date.now(),this.cerberoWorker=new o,this._initListener=this._initListener.bind(this),this._sendToWorker=this._sendToWorker.bind(this),this._receiveWorkerMessage=this._receiveWorkerMessage.bind(this),this._receiveSelectionEvent=this._receiveSelectionEvent.bind(this),this._initListener()}}));
