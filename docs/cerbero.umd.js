!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).cerbero=t()}(this,(function(){"use strict";const e="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&"function"==typeof module.require?module.require:null;var t=function(t){if(e){const n=e("worker_threads").Worker;return function(e){return new n(t,e)}}return function(e){return new Worker(t,e)}}("web-worker-0.js"),n=function(){return(n=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=function(e){var t=e.id;return e.nodeName.toLowerCase()+(t?"#"+t:"")},i=function(e){var t="";return e.parentElement&&(t=i(e.parentElement)),t+" > "+o(e)},r=function(e){var t=e.id,n=e.name,r=e.nodeName,s=e.constructor,c=e.className,a=e.getBoundingClientRect,u={id:t,name:n,className:c,type:r,domType:s.name||"",identifier:o(e),domStructure:i(e),position:a?e.getBoundingClientRect():{}};return e.data&&(u.data=e.data),e.wholeText&&(u.wholeText=e.wholeText),e.nodeValue&&(u.nodeValue=e.nodeValue),e.textContent&&(u.textContent=e.textContent),u},s=function(e){var t,o={};for(var i in e)e[i]&&"MemoryInfo"===e[i].constructor.name?o[i]={totalJSHeapSize:(t=e[i]).totalJSHeapSize,usedJSHeapSize:t.usedJSHeapSize,jsHeapSizeLimit:t.jsHeapSizeLimit}:e[i]instanceof Node?o[i]=r(e[i]):e[i]instanceof Window?o[i]="Window":e[i]instanceof window.InputDeviceCapabilities==!1&&"function"!=typeof e[i]&&(o[i]=e[i]);return o.path=null,n({},o)},c=function(e){var t=this;this.cb=function(e){return null},this.selection="",this.getSelectionText=function(){return window.getSelection().toString()},this.observerValue=function(){var e=t.getSelectionText();e!==t.selection&&""!==e&&(t.selection=e,t.cb({event:window.getSelection(),text:t.selection}))},this.cb=e,this.observerValue=this.observerValue.bind(this),setInterval(this.observerValue,2e3)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */return new function(){var e=this;if(this.textEncoder=new TextEncoder,this.addEventListner=function(t){e.cb=t},this._sendToWorker=function(t,n,o){void 0===o&&(o=!0);var i=o?s(n):n;i.startDate=e.startDate,i=e.textEncoder.encode(JSON.stringify(i)),e.cerberoWorker.postMessage({type:t,event:i})},this._receiveWorkerMessage=function(t){if(!e.cb)throw new Error("[Cerbero] no callback setted");e.cb.apply(null,[t.data])},this._receiveSelectionEvent=function(t){e._sendToWorker("selection",{event:s(t.event),selection:t.text},!1)},this._receiveScrollEvent=function(t){var n=document.body,o=document.documentElement;window.clearTimeout(e.isScrolling),e.isScrolling=setTimeout((function(){var i=Math.max(n.scrollHeight,n.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight);e._sendToWorker("scroll",{event:s(t),height:i,scroll:window.scrollY||window.pageYOffset},!1)}),100)},this._receiveMouseOutEvent=function(t){var n=t.toElement;n&&"HTML"!==n.nodeName||"HTML"===t.fromElement.nodeName||e._sendToWorker("mouseexit",t)},this._initListener=function(){e._sendToWorker("performance",window.performance),document.addEventListener("click",(function(t){return e._sendToWorker("click",t)})),window.addEventListener("mouseout",e._receiveMouseOutEvent,!1),new c(e._receiveSelectionEvent),window.addEventListener("scroll",e._receiveScrollEvent,!1),e.cerberoWorker.onmessage=e._receiveWorkerMessage},"undefined"==typeof Worker)return null;this.startDate=Date.now(),this.cerberoWorker=new t,this._initListener=this._initListener.bind(this),this._sendToWorker=this._sendToWorker.bind(this),this._receiveWorkerMessage=this._receiveWorkerMessage.bind(this),this._receiveSelectionEvent=this._receiveSelectionEvent.bind(this),this._initListener()}}));
